<html>
<head>
<meta name="viewport" content="initial-scale=1.0, user-scalable=no" />
<title>heatmap.js GMaps Heatmap Layer</title>
		<meta name="viewport" content="width=device-width, initial-scale=1.0">
		<style>
			body, html {
				margin:0;
				padding:0;
				font-family:Arial;
			}
			#heatmapArea {
				position:relative;
				float:left;
				width:800px;
				height:600px;
				border:1px dashed black;
			}
		</style>
<script type="text/javascript" src="http://maps.google.com/maps/api/js?sensor=false"></script>

</head>
<body>
			<div id="heatmapArea">
			
			</div>
<script type="text/javascript" src="heatmap.js"></script>
<script type="text/javascript" src="heatmap-gmaps.js"></script>
<script type="text/javascript">

var map;
var heatmap; 

window.onload = function(){

	var myLatlng = new google.maps.LatLng(1.35, 103.8);
	// sorry - this demo is a beta
	// there is lots of work todo
	// but I don't have enough time for eg redrawing on dragrelease right now
	var myOptions = {
	  zoom: 11,
	  center: myLatlng,
	  mapTypeId: google.maps.MapTypeId.ROADMAP,
	  disableDefaultUI: false,
	  scrollwheel: true,
	  draggable: true,
	  navigationControl: true,
	  mapTypeControl: false,
	  scaleControl: true,
	  disableDoubleClickZoom: false
	};
	map = new google.maps.Map(document.getElementById("heatmapArea"), myOptions);
	
	heatmap = new HeatmapOverlay(map, {"radius":15, "visible":true, "opacity":60});
/*	
	document.getElementById("gen").onclick = function(){
		var x = 5;
		while(x--){
		
			var lat = Math.random()*180;
			var lng = Math.random()*180;
			var count = Math.floor(Math.random()*180+1);
			
			heatmap.addDataPoint(lat,lng,count);
		
		}
	
	};
	
	document.getElementById("tog").onclick = function(){
		heatmap.toggle();
	};
*/	

	var hiddenInput = document.getElementById("hiddenInputBox");

	// this is important, because if you set the data set too early, the latlng/pixel projection doesn't work
	google.maps.event.addListenerOnce(map, "idle", function(){
		var testData = JSON.parse(hiddenInput.value);
		heatmap.setDataSet(testData);
	});
};

</script>

<input id="hiddenInputBox" type="hidden" value='{"max": 20, "data": [{"lng": 103.837496346169, "lat": 1.39519347518553, "count": 1}, {"lng": 103.736555571152, "lat": 1.38234616842453, "count": 1}, {"lng": 103.785907550472, "lat": 1.34396003703067, "count": 1}, {"lng": 103.805144795508, "lat": 1.34031927523099, "count": 1}, {"lng": 103.77078357641, "lat": 1.39042601315467, "count": 1}, {"lng": 103.940433712431, "lat": 1.33606729060046, "count": 1}, {"lng": 103.819519540937, "lat": 1.39444596309426, "count": 1}, {"lng": 103.876690699535, "lat": 1.28271393927862, "count": 1}, {"lng": 103.663933884049, "lat": 1.32335794851747, "count": 1}, {"lng": 103.798979058827, "lat": 1.34690304060993, "count": 1}, {"lng": 103.899194767996, "lat": 1.32456933825511, "count": 1}, {"lng": 103.856421875886, "lat": 1.32910340976907, "count": 1}, {"lng": 103.745903643844, "lat": 1.323811859384, "count": 1}, {"lng": 103.783914398025, "lat": 1.29671194477231, "count": 1}, {"lng": 103.774804476292, "lat": 1.30230813666724, "count": 1}, {"lng": 103.763438833149, "lat": 1.31973483194908, "count": 1}, {"lng": 103.854349738556, "lat": 1.34322426578243, "count": 1}, {"lng": 103.858516468764, "lat": 1.3612875290387, "count": 1}, {"lng": 103.8625933596, "lat": 1.33131486776987, "count": 1}, {"lng": 103.788124870718, "lat": 1.29234446767662, "count": 1}, {"lng": 103.787650024225, "lat": 1.34475654399369, "count": 1}, {"lng": 103.963219429047, "lat": 1.3623050846089, "count": 1}, {"lng": 103.800821112833, "lat": 1.28423920372814, "count": 1}, {"lng": 103.781041625589, "lat": 1.34204657392885, "count": 1}, {"lng": 103.853836527719, "lat": 1.30296982718974, "count": 1}, {"lng": 103.840289861661, "lat": 1.30394760119417, "count": 1}, {"lng": 103.805550399258, "lat": 1.28384450462171, "count": 1}, {"lng": 103.800832450591, "lat": 1.34484030161162, "count": 1}, {"lng": 103.80398666081, "lat": 1.28398901357958, "count": 1}, {"lng": 103.903212135447, "lat": 1.3255038605449, "count": 1}, {"lng": 103.771306735542, "lat": 1.41776471834061, "count": 1}, {"lng": 103.7713613099, "lat": 1.41595701495597, "count": 1}, {"lng": 103.7713613099, "lat": 1.41595701495597, "count": 1}, {"lng": 103.94736600772, "lat": 1.34221692348396, "count": 1}, {"lng": 103.839824438996, "lat": 1.35119405977311, "count": 1}, {"lng": 103.795921586403, "lat": 1.42251796184992, "count": 1}, {"lng": 103.905597384991, "lat": 1.39538785839311, "count": 1}, {"lng": 103.858869358688, "lat": 1.32976173574819, "count": 1}, {"lng": 103.806090498553, "lat": 1.41347185345584, "count": 1}, {"lng": 103.863967715097, "lat": 1.27292409472757, "count": 1}, {"lng": 103.875282976606, "lat": 1.28158964766848, "count": 1}, {"lng": 103.776376691821, "lat": 1.3013407653335, "count": 1}, {"lng": 103.773682574614, "lat": 1.40083902154605, "count": 1}, {"lng": 103.771680568707, "lat": 1.41017369174832, "count": 1}, {"lng": 103.837159378719, "lat": 1.39520033084103, "count": 1}, {"lng": 103.963546851111, "lat": 1.35514233873617, "count": 1}, {"lng": 103.909052283494, "lat": 1.37459986253377, "count": 1}, {"lng": 103.81051822572, "lat": 1.33544661585556, "count": 1}, {"lng": 103.827098514693, "lat": 1.32679247003614, "count": 1}, {"lng": 103.827098514693, "lat": 1.32679247003614, "count": 1}, {"lng": 103.911299538399, "lat": 1.30174319351552, "count": 1}, {"lng": 103.801181284545, "lat": 1.34456593116573, "count": 1}, {"lng": 103.771812982561, "lat": 1.39059231666608, "count": 1}, {"lng": 103.774803497994, "lat": 1.30225973506642, "count": 1}, {"lng": 103.85836348846, "lat": 1.38297210370992, "count": 1}, {"lng": 103.858314423114, "lat": 1.38181183221404, "count": 1}, {"lng": 103.756923895698, "lat": 1.3370000381234, "count": 1}, {"lng": 103.837236923824, "lat": 1.33809534073678, "count": 1}, {"lng": 103.663379686279, "lat": 1.32295402290965, "count": 1}, {"lng": 103.907864657147, "lat": 1.36987269263791, "count": 1}, {"lng": 103.771319029944, "lat": 1.42141022550691, "count": 1}, {"lng": 103.857788611682, "lat": 1.32332359377907, "count": 1}, {"lng": 103.858085258692, "lat": 1.37911788765189, "count": 1}, {"lng": 103.783354237504, "lat": 1.29714501576702, "count": 1}, {"lng": 103.963241550025, "lat": 1.35588294636433, "count": 1}, {"lng": 103.77640175272, "lat": 1.30131943194794, "count": 1}, {"lng": 103.849492041286, "lat": 1.27325749442452, "count": 1}, {"lng": 103.819530104417, "lat": 1.32227489384669, "count": 1}, {"lng": 103.708070125563, "lat": 1.36589681529708, "count": 1}, {"lng": 103.764828262419, "lat": 1.30987251866557, "count": 1}, {"lng": 103.948672138923, "lat": 1.36664486123299, "count": 1}, {"lng": 103.870433369326, "lat": 1.32651276750195, "count": 1}, {"lng": 103.792101858892, "lat": 1.28979785401759, "count": 1}, {"lng": 103.76958101052, "lat": 1.39040976554633, "count": 1}, {"lng": 103.891224176189, "lat": 1.32137610201774, "count": 1}, {"lng": 103.846815954298, "lat": 1.32979005682674, "count": 1}, {"lng": 103.899302073473, "lat": 1.29780483302354, "count": 1}, {"lng": 103.756844315069, "lat": 1.31843125844291, "count": 1}, {"lng": 103.907160221719, "lat": 1.32656023217544, "count": 1}, {"lng": 103.797095440956, "lat": 1.42141413245117, "count": 1}, {"lng": 103.758449940988, "lat": 1.33617132648953, "count": 1}, {"lng": 103.771397042736, "lat": 1.4140743935669, "count": 1}, {"lng": 103.858390729453, "lat": 1.38346578673834, "count": 1}, {"lng": 103.855042067983, "lat": 1.27180989072032, "count": 1}, {"lng": 103.751442936943, "lat": 1.34028404765576, "count": 1}, {"lng": 103.752980134241, "lat": 1.33926643659974, "count": 1}, {"lng": 103.838424410494, "lat": 1.31437211848412, "count": 1}, {"lng": 103.872645652241, "lat": 1.40111118790911, "count": 1}, {"lng": 103.85817153972, "lat": 1.38947801047121, "count": 1}, {"lng": 103.838305711856, "lat": 1.31428794045889, "count": 1}, {"lng": 103.72520846616, "lat": 1.37254309050394, "count": 1}, {"lng": 103.852888766886, "lat": 1.28399832329457, "count": 1}, {"lng": 103.768611839612, "lat": 1.43430131542936, "count": 1}, {"lng": 103.734229331604, "lat": 1.38024720851245, "count": 1}, {"lng": 103.882001689471, "lat": 1.32101123631755, "count": 1}, {"lng": 103.857878189347, "lat": 1.35948488443923, "count": 1}, {"lng": 103.776489011472, "lat": 1.3012728501208, "count": 1}, {"lng": 103.84646899547, "lat": 1.27255301139553, "count": 1}, {"lng": 103.88601859269, "lat": 1.32218265830125, "count": 1}, {"lng": 103.795748706882, "lat": 1.28723023861783, "count": 1}, {"lng": 103.899714252552, "lat": 1.32471988282834, "count": 1}, {"lng": 103.753623468719, "lat": 1.32126047694239, "count": 1}, {"lng": 103.768977586136, "lat": 1.43105798083742, "count": 1}, {"lng": 103.880946690153, "lat": 1.32052777466655, "count": 1}, {"lng": 103.847205404061, "lat": 1.34857381363802, "count": 1}, {"lng": 103.826238969246, "lat": 1.29059131720188, "count": 1}, {"lng": 103.811342923373, "lat": 1.40332123836051, "count": 1}, {"lng": 103.858664060488, "lat": 1.34851087650376, "count": 1}, {"lng": 103.90342445642, "lat": 1.32556715998247, "count": 1}, {"lng": 103.874622071544, "lat": 1.32117949208157, "count": 1}, {"lng": 103.913502138282, "lat": 1.32952101081143, "count": 1}, {"lng": 103.87182521071, "lat": 1.32526941687558, "count": 1}, {"lng": 103.860746057619, "lat": 1.3185604554686, "count": 1}, {"lng": 103.943026141901, "lat": 1.33819571107394, "count": 1}, {"lng": 103.811807587959, "lat": 1.32045417177023, "count": 1}, {"lng": 103.863195863395, "lat": 1.27285501940601, "count": 1}, {"lng": 103.906042937042, "lat": 1.30027231296965, "count": 1}, {"lng": 103.897956598967, "lat": 1.29728413504678, "count": 1}, {"lng": 103.839678161047, "lat": 1.27972862155189, "count": 1}, {"lng": 103.794926126828, "lat": 1.4226017075577, "count": 1}, {"lng": 103.861301502949, "lat": 1.33029168489467, "count": 1}, {"lng": 103.85823817937, "lat": 1.3870099098067, "count": 1}, {"lng": 103.866226406199, "lat": 1.30426952025015, "count": 1}, {"lng": 103.860706300739, "lat": 1.33039261868696, "count": 1}, {"lng": 103.84187095091, "lat": 1.36079388131179, "count": 1}, {"lng": 103.793705539051, "lat": 1.34887376869131, "count": 1}, {"lng": 103.816441619123, "lat": 1.33245003408891, "count": 1}, {"lng": 103.738004909611, "lat": 1.34530224077222, "count": 1}, {"lng": 103.857761385438, "lat": 1.32331536433162, "count": 1}, {"lng": 103.866423423015, "lat": 1.32892080360134, "count": 1}, {"lng": 103.910539925591, "lat": 1.39028123118217, "count": 1}, {"lng": 103.850385020316, "lat": 1.27407099203993, "count": 1}, {"lng": 103.771361520164, "lat": 1.41548339080445, "count": 1}, {"lng": 103.789775959307, "lat": 1.29131190225439, "count": 1}, {"lng": 103.816434444618, "lat": 1.39487215153598, "count": 1}, {"lng": 103.909612092461, "lat": 1.37428568683199, "count": 1}, {"lng": 103.9200811155, "lat": 1.33269191966782, "count": 1}, {"lng": 103.814889526514, "lat": 1.33336858592668, "count": 1}, {"lng": 103.92348948574, "lat": 1.37849843812972, "count": 1}, {"lng": 103.87777187297, "lat": 1.2955433183229, "count": 1}, {"lng": 103.760745261345, "lat": 1.31578286474902, "count": 1}, {"lng": 103.844348760836, "lat": 1.29850530930206, "count": 1}, {"lng": 103.856860407005, "lat": 1.34328836219391, "count": 1}, {"lng": 103.774012814528, "lat": 1.39358645903851, "count": 1}, {"lng": 103.829151229837, "lat": 1.39792274646588, "count": 1}, {"lng": 103.818956564262, "lat": 1.33674044587909, "count": 1}, {"lng": 103.755074880645, "lat": 1.388762218712, "count": 1}, {"lng": 103.82513616783, "lat": 1.3275550335476, "count": 1}, {"lng": 103.855568081228, "lat": 1.39900689532696, "count": 1}, {"lng": 103.737712447795, "lat": 1.38327300670744, "count": 1}, {"lng": 103.837391736832, "lat": 1.3273201894258, "count": 1}, {"lng": 103.857946741818, "lat": 1.39374173657122, "count": 1}, {"lng": 103.777274633192, "lat": 1.37503107548521, "count": 1}, {"lng": 103.8592672578, "lat": 1.34694076697185, "count": 1}, {"lng": 103.977165208973, "lat": 1.33269449430751, "count": 1}, {"lng": 103.903179248475, "lat": 1.3255068639668, "count": 1}, {"lng": 103.903179248475, "lat": 1.3255068639668, "count": 1}, {"lng": 103.855825281471, "lat": 1.2930133873019, "count": 1}, {"lng": 103.724714047505, "lat": 1.32447049602036, "count": 1}, {"lng": 103.81668333371, "lat": 1.33202329325412, "count": 1}, {"lng": 103.849717769423, "lat": 1.31771137278482, "count": 1}, {"lng": 103.768315537802, "lat": 1.30595471669642, "count": 1}, {"lng": 103.869470492229, "lat": 1.32745593445638, "count": 1}, {"lng": 103.860496301874, "lat": 1.33063100245529, "count": 1}, {"lng": 103.861699782137, "lat": 1.32743398803823, "count": 1}, {"lng": 103.903500834083, "lat": 1.32558913384947, "count": 1}, {"lng": 103.795551184128, "lat": 1.3490107280209, "count": 1}, {"lng": 103.903637055409, "lat": 1.32561110600501, "count": 1}, {"lng": 103.770400111659, "lat": 1.30451892006606, "count": 1}, {"lng": 103.785014981057, "lat": 1.42528946042494, "count": 1}, {"lng": 103.776096114662, "lat": 1.42491376307626, "count": 1}, {"lng": 103.699294172886, "lat": 1.3563545072773, "count": 1}, {"lng": 103.811396928218, "lat": 1.40331997276121, "count": 1}, {"lng": 103.813353887142, "lat": 1.39930680284687, "count": 1}, {"lng": 103.755128822684, "lat": 1.3985547382154, "count": 1}, {"lng": 103.786594314117, "lat": 1.34428371324799, "count": 1}, {"lng": 103.838610630589, "lat": 1.28628489886816, "count": 1}, {"lng": 103.867082864356, "lat": 1.32896996491736, "count": 1}, {"lng": 103.859957949572, "lat": 1.34475456713846, "count": 1}, {"lng": 103.881025144415, "lat": 1.32061623807271, "count": 1}, {"lng": 103.801062293577, "lat": 1.41874430184914, "count": 1}, {"lng": 103.765469114977, "lat": 1.39058302573523, "count": 1}, {"lng": 103.765469115054, "lat": 1.39058031264476, "count": 1}, {"lng": 103.934317057035, "lat": 1.3088961480172, "count": 1}, {"lng": 103.852004250848, "lat": 1.29592871978193, "count": 1}, {"lng": 103.906122468783, "lat": 1.32549311373489, "count": 1}, {"lng": 103.844547011848, "lat": 1.3298803328758, "count": 1}, {"lng": 103.903424456269, "lat": 1.32556176092977, "count": 1}, {"lng": 103.882638687444, "lat": 1.32128278619648, "count": 1}, {"lng": 103.818483748231, "lat": 1.3944486698409, "count": 1}, {"lng": 103.81848374818, "lat": 1.39445689955392, "count": 1}, {"lng": 103.740668343425, "lat": 1.32579296556336, "count": 1}, {"lng": 103.8481188917, "lat": 1.3169386756091, "count": 1}, {"lng": 103.846551956159, "lat": 1.27586597113495, "count": 1}, {"lng": 103.786837089053, "lat": 1.42848119608175, "count": 1}, {"lng": 103.859386633833, "lat": 1.29977754002529, "count": 1}, {"lng": 103.915545103199, "lat": 1.37996672611125, "count": 1}, {"lng": 103.795210798764, "lat": 1.34906957870341, "count": 1}, {"lng": 103.844104415782, "lat": 1.29546772079971, "count": 1}, {"lng": 103.841274930308, "lat": 1.3270666051561, "count": 1}, {"lng": 103.859498585334, "lat": 1.40079205090832, "count": 1}, {"lng": 103.773911461834, "lat": 1.39617332525925, "count": 1}, {"lng": 103.939624912929, "lat": 1.33544168763805, "count": 1}, {"lng": 103.787945979423, "lat": 1.42616890547217, "count": 1}, {"lng": 103.80547014204, "lat": 1.28381620616791, "count": 1}, {"lng": 103.79789447302, "lat": 1.42101749100245, "count": 1}, {"lng": 103.800670975888, "lat": 1.34508801387519, "count": 1}, {"lng": 103.874673615225, "lat": 1.31807872404999, "count": 1}, {"lng": 103.789904188011, "lat": 1.34841590521938, "count": 1}, {"lng": 103.790209416498, "lat": 1.34864906481137, "count": 1}, {"lng": 103.789904188011, "lat": 1.34841590521938, "count": 1}, {"lng": 103.790209416498, "lat": 1.34864906481137, "count": 1}, {"lng": 103.859396733178, "lat": 1.33007104998855, "count": 1}, {"lng": 103.811829670861, "lat": 1.33438300468282, "count": 1}, {"lng": 103.962488756493, "lat": 1.3578311455885, "count": 1}, {"lng": 103.812681865795, "lat": 1.33399668560572, "count": 1}, {"lng": 103.940323292932, "lat": 1.37142021280549, "count": 1}, {"lng": 103.76352524644, "lat": 1.33353490349638, "count": 1}, {"lng": 103.768579520351, "lat": 1.43354867631554, "count": 1}, {"lng": 103.675159139135, "lat": 1.33131255061145, "count": 1}, {"lng": 103.789707926793, "lat": 1.34826226830035, "count": 1}, {"lng": 103.817760255068, "lat": 1.33178950401914, "count": 1}, {"lng": 103.731533537334, "lat": 1.37800978180575, "count": 1}, {"lng": 103.812154625376, "lat": 1.40198144875799, "count": 1}, {"lng": 103.860839551249, "lat": 1.2895285488815, "count": 1}, {"lng": 103.859060753212, "lat": 1.36254829746527, "count": 1}, {"lng": 103.860423765856, "lat": 1.36918805215141, "count": 1}, {"lng": 103.858323862385, "lat": 1.38307638635449, "count": 1} ]}' />
</body>
</html>